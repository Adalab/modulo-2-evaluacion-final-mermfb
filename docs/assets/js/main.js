"use strict";const formElement=document.querySelector(".form"),inputElement=document.querySelector(".input"),buttonElement=document.querySelector(".button"),resultSectionElement=document.querySelector(".resultsection"),favoritesSectionElement=document.querySelector(".favoritessection"),resetButton=document.querySelector(".resetButton");let shows=[],favorites=[];function getDataFromApi(){const e="http://api.tvmaze.com/search/shows?q="+inputElement.value;event.preventDefault(),fetch(e).then(e=>e.json()).then(e=>{shows=e,console.log(shows),paintShows()})}function paintFavorites(){favoritesSectionElement.innerHTML="";const e=document.createElement("h2"),t=document.createTextNode("Mis series favoritas");e.appendChild(t),favoritesSectionElement.appendChild(e);const o=document.createElement("ul");favoritesSectionElement.appendChild(o);for(const e of favorites){let t;const n=e.show.id,s=e.show.name;t="show--favorite";const i=document.createElement("li");i.setAttribute("class","favoriteItem"),i.setAttribute("id",n),o.appendChild(i);const l=document.createElement("div");l.setAttribute("class","favoriteButton");const a=document.createTextNode("X");l.appendChild(a),i.appendChild(l);const c=document.createElement("h3");c.setAttribute("class","favoriteTitle");let r=document.createTextNode(s);c.appendChild(r),i.appendChild(c);let d=document.createElement("img");null===e.show.image?d.src="https://via.placeholder.com/210x295/ffffff/666666/?\n      text=TV":null===e.show.image.medium?d.src=e.show.image.original:d.src=e.show.image.medium,i.appendChild(d)}listenFavoritesEvents()}const list=document.createElement("ul");function paintShows(){list.innerHTML="";for(let e of shows){let t;t=isFavoriteShow(e)?"show--favorite":"";const o=e.show.id,n=e.show.name,s=document.createElement("li");s.setAttribute("class",t+" js-show"),s.setAttribute("id",o),list.appendChild(s);const i=document.createElement("h3");let l=document.createTextNode(n);i.appendChild(l),s.appendChild(i);let a=document.createElement("img");null===e.show.image?a.src="https://via.placeholder.com/210x295/ffffff/666666/?\n        text=TV":null===e.show.image.medium?a.src=e.show.image.original:a.src=e.show.image.medium,s.appendChild(a),console.log(s)}listenShowsEvents()}function isFavoriteShow(e){const t=favorites.find(t=>(console.log("dentro del find",e.show.id),console.log("favorite",t,"show",e),t.show.id===e.show.id));return console.log("show encontrado",t,e.show.id),void 0!==t}function listenShowsEvents(){const e=document.querySelectorAll(".js-show");console.log(e);for(let t of e)t.addEventListener("click",handleShow);saveInLocalStorage()}function listenFavoritesEvents(){const e=document.querySelectorAll(".favoriteItem");for(let t of e)t.addEventListener("click",handleShow);saveInLocalStorage()}function handleShow(e){const t=parseInt(e.currentTarget.id);console.log("id del show clickado",t);const o=favorites.findIndex((function(e){return e.show.id===t}));shows.find((function(e){return e.show.id===t}));if(-1===o){const e=shows.find((function(e){return e.show.id===t}));console.log(e),favorites.push(e),console.log("Mis favoritas",favorites)}else favorites.splice(o,1);paintShows(),paintFavorites()}function resetFavorites(){favorites=[],paintFavorites(),saveInLocalStorage(),console.log("FAVORITOS CON RESET",favorites)}function saveInLocalStorage(){const e=JSON.stringify(favorites);localStorage.setItem("favorites",e)}function getFromLocalStorage(){const e=localStorage.getItem("favorites");if(null!==e){const t=JSON.parse(e);favorites=t,paintShows(),console.log(favorites)}}list.setAttribute("class","js-showlist"),resultSectionElement.appendChild(list),console.log("Mis favoritas",favorites),buttonElement.addEventListener("click",getDataFromApi),getFromLocalStorage(),paintFavorites(),resetButton.addEventListener("click",resetFavorites);